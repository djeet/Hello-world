// Generated by CoffeeScript 1.4.0(function() {   var arr, c, deleteAllCookies, draw_pagination, filter_array, load_data, filtered, getCookie, intersect, refresh_venues, save_all_cookies, scrolled, selected, setCookie, sortBy, val, venue_data, venue_filters, x, _i, _j, _k, _len, _len1, _len2,   __indexOf = [].indexOf || function(item) {      for (var i = 0, l = this.length; i < l; i++) {         if (i in this && this[i] === item) return i;      }      return -1;   };      intersect = function(arr1, arr2) {      var i, l, o, r, v;      r = [];      o = {};      l = arr2.length;      i = void 0;      v = void 0;      i = 0;      while (i < l) {         o[arr2[i]] = true;         i++;      }      l = arr1.length;      i = 0;      while (i < l) {         v = arr1[i];         if (v in o) {            r.push(v);         }         i++;      }      return r;   };      sortBy = function(key, a, b, r) {      r = r ? 1 : -1;      if (parseInt(a['filters'][key]) > parseInt(b['filters'][key])) {         return -1 * r;      }      if (parseInt(a['filters'][key]) < parseInt(b['filters'][key])) {         return +1 * r;      }      return 0;   };      filtered = [];      venue_data = [];      filter_array = [];      //   $.get($('#router_url').val()//, domain + 'api/proxy?get_url=browse'   //      , {   //         q: 2   //      }, function(data) {   //         if (data.success) {   //            filtered = data.result;   //            venue_data = data.result;   //            draw_pagination();   //            return load_data();//refresh_venues();   //         } else {   //            return filtered = [];   //         }   //      }, 'json');      draw_pagination = function(pagenum) {      var html, i, num_of_venues, pages_to_show, _i;      if (pagenum == null) {         pagenum = 1;      }      $('div.pagination .numbers').empty();      num_of_venues = filtered.length;      pages_to_show = Math.ceil(num_of_venues / 20);      for (i = _i = 1; _i <= pages_to_show; i = _i += 1) {         html = "<a data-pagenum=\"" + i + "\">" + i + "</a>";         $('div.pagination .numbers').append(html);      }      if (pages_to_show === 1) {         $('div.page-arrows').hide();      } else {         $('div.page-arrows').show();      }      return $('div.pagination .numbers a[data-pagenum=' + pagenum + ']').addClass('selected');   };      scrolled = 1;      refresh_venues = function(pagenum) {      var domain, html, is_last, results_to_show, url_array, v, _i, _len;      $('div.container.results div.row').not('.loading').fadeOut('fast').addClass('remove');      $('div.container.results div.row.loading').fadeIn('fast');      if (scrolled <= 2 && pagenum === void 0) {         scrolled++;         $('html,body').animate({            scrollTop: $('#browse-menu-div').offset().top         }, 500);      }            filtered = venue_data != null ? venue_data : [];      results_to_show = 20;      filtered = filtered.filter(function(element, index, array) {         var filter_attendees, filter_fac, filter_loc, filter_menu, filter_price, filter_priv, filter_types, price, _ref, _ref1;         if (element.filters.type !== null && venue_filters.length > 0) {            filter_types = intersect(venue_filters, element.filters.type.split(', ')).length > 0;         } else {            filter_types = true;         }         if (element.filters.facility !== null && filter_array['fac'].length > 0) {            filter_fac = intersect(filter_array['fac'], element.filters.facility.split(', ')).length > 0;         } else {            filter_fac = true;         }         if (element.filters.location !== null && filter_array['loc'].length > 0) {            filter_loc = intersect(filter_array['loc'], element.filters.location.split(', ')).length > 0;         } else {            filter_loc = true;         }         if (element.filters.menu !== null && filter_array['menu'].length > 0) {            filter_menu = intersect(filter_array['menu'], element.filters.menu.split(', ')).length > 0;         } else {            filter_menu = true;         }         if (element.filters.privacy !== null && filter_array['priv'].length > 0) {            filter_priv = (_ref = element.filters.privacy, __indexOf.call(filter_array['priv'], _ref) >= 0);         } else {            filter_priv = true;         }         if (isNaN(parseInt($('input#txtAttendees').val()))) {            filter_attendees = parseInt(element.filters.max_attendees) >= 1;         } else {            filter_attendees = ((parseInt($('input#txtAttendees').val()) * 2) >= (_ref1 = parseInt(element.filters.max_attendees)) && _ref1 >= parseInt($('input#txtAttendees').val()));         }         if (parseInt($('#budget').attr('data-value')) === 50000) {            price = 999999;                  } else {            price = parseInt($('#budget').attr('data-value'));         }         if (element.filters.min_spend_total !== null) {            filter_price = price >= parseInt(element.filters.min_spend_total);         } else {            filter_price = true;         }         // alert(filter_price);         return filter_attendees && filter_price && filter_types && filter_fac && filter_loc && filter_menu && filter_priv;      });      switch (parseInt($('span#sort-value').attr('data-value'))) {         case 1:            filtered.sort(function(a, b) {               return sortBy('ranking', a, b, true);            });            break;         case 2:            filtered.sort(function(a, b) {               return sortBy('min_spend_total', a, b);            });            break;         case 3:            filtered.sort(function(a, b) {               return sortBy('min_spend_total', a, b, true);            });            break;         case 4:            filtered.sort(function(a, b) {               return sortBy('max_attendees', a, b);            });            break;         case 5:            filtered.sort(function(a, b) {               return sortBy('max_attendees', a, b, true);            });      }      if (filtered.length === 0) {         html = "<div class=\"row\">\n  <div class=\"col twelve last text-center\">\n    <h4>Sorry :(</h4>\n    <p>We couldn't find any venues which match this criteria</p>\n    <a href=\"javascript:void(0);\" class=\"button blue\" style=\"display: inline-block; width: auto; height: auto;\" onclick=\"location.reload();\">Reset Filters</a>\n    <br>\n    <br>\n  </div>\n</div.";         $('div.container.results div.row.loading').fadeOut(100);         $('div.results').delay(200).append(html);         $('div.pagination').hide();         return $('div.results-text').hide();      } else {         $('div.pagination').show();         $('div.results-text').show();         for (_i = 0, _len = filtered.length; _i < _len; _i++) {            v = filtered[_i];            if (($('div.numbers a.selected').data('pagenum') * results_to_show > _i && _i >= ($('div.numbers a.selected').data('pagenum') - 1) * results_to_show)) {               $('span#results-min').text((($('div.numbers a.selected').data('pagenum') - 1) * results_to_show) + 1);               if (($('div.numbers a.selected').data('pagenum') * results_to_show) > filtered.length) {                  $('span#results-max').text(filtered.length);               } else {                  $('span#results-max').text($('div.numbers a.selected').data('pagenum') * results_to_show);               }               $('span#results-count').text(filtered.length);               if (_i === $('div.numbers a.selected').data('pagenum') * results_to_show) {                  break;               }               if (_i % 4 === 0) {                  $('div.container.results').append("<div class=\"row tall\" style='display:none'></div>");               }               is_last = "";               if (_i % 4 === 3) {                  is_last = " last";               }               url_array = document.URL.split("/browse");               domain = url_array[0];               html = "<a class=\"space-link\" href=\"" + domain + "/" + v.venue_slug + "/" + v.space_slug + "\" title=\"" + v.venue_name + " (" + v.space_name + ")\">\n  <div class=\"col three" + is_last + "\">\n    <div class=\"venue\">\n      <h3>" + v.venue_name + "</h3>\n      <p>" + v.space_name + "</p>\n      <hr>\n      <div class=\"text-center\" style=\"height: 176px;\">\n        <img src=\"" + v.image_url + "\" alt=\"" + v.venue_name + "\" title=\"" + v.venue_name + "\">\n        <p class=\"blue\">" + v.suburb + "</p>\n      </div>\n      <hr>\n      <p class=\"floats\">\n        <i class=\"icon-group\"></i> Up to " + v.filters.max_attendees + "</p>\n      <p class=\"floats\">\n        <i class=\"icon-money\"></i> " + v.min_spend + "</p>\n      <div style=\"height:1px;clear:both\"></div>\n    </div>\n  </div>\n</a>";               $('div.container.results div.row:last').append(html);            }         }         $('div.container.results div.row.loading').delay(350).fadeOut(100);         $('div.row.tall').delay(400).fadeIn(200);         $('div.container.results div.row.remove').remove();         return draw_pagination(pagenum);      }   };            load_data = function (){      var price , filter_attendees ;                   if (parseInt($('#budget').attr('data-value')) === 50000) {         price = 999999;            } else {                  price = parseInt($('#budget').attr('data-value'));      }      //                              if (isNaN($('input#txtAttendees').val())) {            $('#txtAttendees').css('background-color','red');         // alert('please Enter the numeric value'); //alert($('input#txtAttendees').val());         return false;         filter_attendees = '10' ;            } else {         $('#txtAttendees').css('background-color','#FFFFFF');          filter_attendees = $('input#txtAttendees').val();      }            var state_t9 = $('#state_selection').val();      var event_t9 = $('#event-value').attr('data-value');      var attendees_t9 = filter_attendees;  //          filter_attendees;      var budget_t9 = price;      var sort_t9 = $('#sort-value').attr('data-value');      var categories_t9 = venue_filters;      var location_t9 = filter_array['loc'];      var facilities_t9 = filter_array['fac'];      var privacy_t9 = filter_array['priv'];      var foodndrinks_t9 = filter_array['menu'];      var page = $('#pgNumber').val();      var pgLimit = $('#pgLimit').val();            $('.loading').show();      $.ajax({         url:$('#router_url').val(),         data:'q=1&state='+state_t9+'&event_type='+event_t9+'&attendees='+attendees_t9+'&budget='+budget_t9+'&sort='+sort_t9+'&categories='+categories_t9+'&location='+location_t9+'&facilities='+facilities_t9+'&privacy='+privacy_t9+'&foodndrinks='+foodndrinks_t9+'&page='+page+'&pgLimit='+pgLimit,         success: function(data){            $('#collect_ajax_source').empty();            $('.loading').hide();            $('#collect_ajax_source').html(data);         }      })   }      $('a.space-link').live('click', function(event) {      event.preventDefault();      save_all_cookies();      return window.location.href = $(this).attr('href');   });      save_all_cookies = function() {      setCookie('budget', $('#budget').attr('data-value'));      setCookie('event', $('#event-value').attr('data-value'));      setCookie('attendees', $('input#txtAttendees').val());      setCookie('sort', $('#sort-value').attr('data-value'));      $('div.popdown.hidden').find('input:checkbox:checked').each(function() {         var cookie_name;         cookie_name = $(this).parents('div.popdown.hidden').attr('class').replace(/hidden|popdown|\s/g, '');         if (getCookie(cookie_name) === void 0) {            return setCookie(cookie_name, $(this).attr('value'));         } else {            return setCookie(cookie_name, $(this).attr('value') + '|' + getCookie(cookie_name));         }      });      return $('#refine').find('a.selected').each(function() {         if (getCookie('refine') === void 0) {            return setCookie('refine', $(this).attr('data-value'));         } else {            return setCookie('refine', $(this).attr('data-value') + '|' + getCookie('refine'));         }      });   };      $('a.clicky').click(function() {      var name;      name = $(this).attr('rel');      $("div.popdown:not(." + name + ")").hide();      $("a.clicky[rel!=" + name + "]").children("i.icon-chevron-up").toggleClass('icon-chevron-down icon-chevron-up');      $('div.popdown.' + name).slideToggle('fast');      return $(this).children('i').toggleClass('icon-chevron-down icon-chevron-up');   });      $('div.venue').live('hover', function() {      return $(this).toggleClass('hover');   });      $('div.budget.popdown a').click(function() {      $('span#budget').text($(this).text());      $('span#budget').attr('data-value', $(this).attr('data-value'));      $('div.budget.popdown').slideToggle('fast');      return load_data();//refresh_venues(); //786   });      $('div.sort.popdown a').click(function() {      $('span#sort-value').text($(this).text());      $('div.sort.popdown').slideToggle('fast');      $('span#sort-value').attr('data-value', $(this).attr('data-value'));      return load_data();//refresh_venues(); //786   });      venue_filters = [];      $('div.box').click(function() {      $('>a', this).toggleClass('selected');      if ($('>a', this).hasClass('selected')) { //alert($('>a', this).attr('data-value'));         venue_filters.push($('>a', this).attr('data-value'));      } else {         venue_filters.splice(venue_filters.indexOf($('>a', this).attr('data-value')), 1);      }            return load_data();//refresh_venues(); //786   });      $('div.event.popdown a').click(function() {      var browse_url, url_array;      $('span#event-value').text($(this).text());      $('span#event-value').attr('data-value',$(this).attr('data-value'));      // alert(getCookie('load-cookies'));      setCookie('load-cookies', 'true');      save_all_cookies();      $('div.event.popdown').slideToggle('fast');      return load_data();   //  url_array = document.URL.split("/browse");   //  browse_url = url_array[0] + '/browse/' + city.toLowerCase() + '/' + $(this).data('value');   //  return window.location = browse_url;   });      $('.numbers a').live('click', function() {      if ($(this).hasClass('selected')) {         return $('html,body').animate({            scrollTop: $('div.options').offset().top         }, 500);      } else {         $('.numbers a.selected').removeClass('selected');         $(this).addClass('selected');         $('html,body').animate({            scrollTop: $('div.options').offset().top         }, 500); //alert('yahoo');         return refresh_venues($(this).data('pagenum'));      }   });      $('div.page-arrows a:first').click(function() {      var current_page, first_visible_page;      first_visible_page = $('div.pagination .numbers a:first').data('pagenum');      current_page = $('div.pagination .numbers .selected').data('pagenum');      if (current_page > first_visible_page) {         $('div.pagination .numbers a[data-pagenum=' + current_page + ']').removeClass('selected');         $('div.pagination .numbers a[data-pagenum=' + (current_page - 1) + ']').addClass('selected');      }      $('html,body').animate({         scrollTop: $('div.options').offset().top      }, 500);      return refresh_venues($('div.pagination .numbers a.selected').data('pagenum'));   });      $('div.page-arrows a:last').click(function() {      var current_page, last_visible_page;      last_visible_page = $('div.pagination .numbers a:last').data('pagenum');      current_page = $('div.pagination .numbers .selected').data('pagenum');      if (current_page < last_visible_page) {         $('div.pagination .numbers a[data-pagenum=' + current_page + ']').removeClass('selected');         $('div.pagination .numbers a[data-pagenum=' + (current_page + 1) + ']').addClass('selected');      }      $('html,body').animate({         scrollTop: $('div.options').offset().top      }, 500);      return refresh_venues($('div.pagination .numbers a.selected').data('pagenum'));   });      filter_array['loc'] = [];      filter_array['fac'] = [];      filter_array['priv'] = [];      filter_array['menu'] = [];      $('div.loc input.select-all').click(function() {      var x;      if ($(this).is(':checked')) {         x = $(this).attr('data-value');//val();         $("div." + x + " input").each(function() {            $(this).attr('checked', 'checked');            if ($(this).is(':checked')) {               if (filter_array['loc'].indexOf($(this).val()) === -1) {                  return filter_array['loc'].push($(this).val());               }            } else {               return filter_array['loc'].splice(filter_array['loc'].indexOf($(this).val()), 1);            }         });      } else {         x = $(this).attr('data-value');//val();         $("div." + x + " input").each(function() {            $(this).removeAttr('checked');            if ($(this).is(':checked')) {               return filter_array['loc'].push($(this).val());             } else {               return filter_array['loc'].splice(filter_array['loc'].indexOf($(this).val()), 1);            }         });      }      return load_data();//refresh_venues(); //786   });      $('div.loc input[class!="select-all"]').click(function() {      var region;      region = $(this).parent().attr('class');      if ($(this).is(':checked')) {         filter_array['loc'].push($(this).val());         if ($("div.loc div." + region + " input:checkbox:checked").length === $("div.loc div." + region + " input:checkbox").length) {            $("input:checkbox[value='" + region + "']").attr('checked', 'checked');         }       } else {         filter_array['loc'].splice(filter_array['loc'].indexOf($(this).val()), 1);         $("input:checkbox[value='" + region + "']").removeAttr('checked');      } //alert(filter_array['loc']);      return load_data();//refresh_venues(); //786   });      $('div.facilities_t9 input').click(function() {      if ($(this).is(':checked')) {         filter_array['fac'].push($(this).val());      } else {         filter_array['fac'].splice(filter_array['fac'].indexOf($(this).val()), 1);      }      return load_data();//refresh_venues(); //786   });      $('div.priv input').click(function() {      if ($(this).is(':checked')) {         filter_array['priv'].push($(this).val());      } else {         filter_array['priv'].splice(filter_array['priv'].indexOf($(this).val()), 1);      }      return load_data();//refresh_venues(); //786   });      $('div.menu input').click(function() {      if ($(this).is($('div.menu input:first'))) {         if ($(this).is(':checked')) {            $('div.menu input').attr('disabled', '').attr('checked', false);            $('div.menu input:first').removeAttr('disabled').attr('checked', true);            filter_array['menu'] = [];            return load_data();//refresh_venues(); //786         } else {            return $('div.menu input').removeAttr('disabled');         }      } else {         if ($(this).is(':checked')) {            filter_array['menu'].push($(this).val());         } else {            filter_array['menu'].splice(filter_array['menu'].indexOf($(this).val()), 1);         }         return load_data();//refresh_venues(); //786      }   });      $('input#txtAttendees').keyup(function() {      return load_data();//refresh_venues(); //786   });      $('input#txtAttendees').blur(function() {      return load_data();//refresh_venues(); //786   });      setCookie = function(field, value, prepend, expire_time) {      var expire_date;      if (prepend == null) {         prepend = 'venuemob-browse-';      }      if (expire_time == null) {         expire_time = 1;      }      expire_date = new Date();      expire_date.setDate(expire_date.getDate() + expire_time);      expire_date = '; expires=' + expire_date.toUTCString();      return document.cookie = prepend + field + '=' + value + expire_date + '; path=/';   };      getCookie = function(field) {      var all_cookies, cookie, x, _i, _j, _len, _len1;      field = 'venuemob-browse-' + field;      all_cookies = document.cookie.split('; ');      for (_i = 0, _len = all_cookies.length; _i < _len; _i++) {         cookie = all_cookies[_i];         cookie = cookie.split('=');         for (_j = 0, _len1 = cookie.length; _j < _len1; _j++) {            x = cookie[_j];            if (field === x) {               return cookie[1];            }         }      }   };      deleteAllCookies = function() {      var all_cookies, cookie, field, _i, _len, _results;      field = 'venuemob-browse-';      all_cookies = document.cookie.split('; ');      _results = [];      for (_i = 0, _len = all_cookies.length; _i < _len; _i++) {         cookie = all_cookies[_i];         cookie = cookie.split('=');         if (cookie[0].indexOf(field) !== -1) {            _results.push(setCookie(cookie[0], cookie[1], '', -1));         } else {            _results.push(void 0);         }      }      return _results;   };      if (getCookie('load-cookies') === 'true') {      if (getCookie('attendees') !== void 0 && $('input#txtAttendees').val() !== getCookie('attendees')) {         $('input#txtAttendees').val(getCookie('attendees'));      }      if (getCookie('budget') !== void 0 && $('span#budget').attr('data-value') !== getCookie('budget')) {         val = getCookie('budget');         $('span#budget').text($("div.budget a[data-value='" + val + "']").text());         $('span#budget').attr('data-value', val);      }      if (getCookie('sort') !== void 0 && $('span#sort-value').attr('data-value') !== getCookie('sort')) {         val = getCookie('sort');         $('span#sort-value').text($("div.sort a[data-value='" + val + "']").text());         $('span#sort-value').attr('data-value', val);      }      if (getCookie('refine') !== void 0) {         selected = getCookie('refine').split('|');         for (_i = 0, _len = selected.length; _i < _len; _i++) {            x = selected[_i];            venue_filters.push(x);            $('div#refine').find("a[data-value='" + x + "']").addClass('selected');         }      }      arr = ['loc', 'fac', 'priv', 'menu'];      for (_j = 0, _len1 = arr.length; _j < _len1; _j++) {         c = arr[_j];         if (getCookie(c) !== void 0) {            selected = getCookie(c).split('|');            for (_k = 0, _len2 = selected.length; _k < _len2; _k++) {               x = selected[_k];               filter_array[c].push(x);               $("div.popdown." + c).find("input[value=\"" + x + "\"]:checkbox").attr('checked', 'checked');            }         }      }      return load_data();//refresh_venues(); //786   }      deleteAllCookies();}).call(this);